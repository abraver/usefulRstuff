<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Aaron Braver">
<meta name="dcterms.date" content="2024-05-17">
<title>Useful R Stuff - Tables for Word in flextable</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-N1MBV4L3FV"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-N1MBV4L3FV', { 'anonymize_ip': true});
</script><link href="../../site_libs/roboto-condensed-0.3.7/css/roboto-condensed.css" rel="stylesheet">
<link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script><link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Useful R Stuff - Tables for Word in flextable">
<meta property="og:description" content="">
<meta property="og:site-name" content="Useful R Stuff">
<meta name="twitter:title" content="Useful R Stuff - Tables for Word in flextable">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-md navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Useful R Stuff</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="http://www.aaronbraver.com" rel="" target="">
 <span class="menu-text">Aaron Braver</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text">RSS</span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Tables for Word in <code>flextable</code>
</h1>
  <div class="quarto-categories">
    <div class="quarto-category">tables</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://www.aaronbraver.com">Aaron Braver</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 17, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header><script src="../../jquery-3.7.0.min.js"></script><script src="../../fold.js"></script><script src="../../move_session_info.js"></script><!-- begin content --><div class="cell" data-hash="index_cache/html/setup_2ba6a52b786234c62804130cb975095e">
<details><summary>Setup</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ardata-fr.github.io/flextable-book/">flextable</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>On those occasions where I have a coauthor working in Word rather than LaTeX, it’s sometimes useful to be able to output nicely formatted, editable tables directly from R. I like the tables from <code>gt</code>, but they don’t render certain style and formatting options correctly in Word or RTF output (see <a href="https://github.com/rstudio/gt/issues/1098">this issue</a>).<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>So, in this post I’ll show some tables made with <code>flextable</code>, which has better Word support.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
If you don’t need editability or formatting…
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are a few options if you don’t need editable output, or output with fancy formatting.</p>
<section id="editable-but-not-pretty" class="level3"><h3 class="anchored" data-anchor-id="editable-but-not-pretty">Editable but not pretty</h3>
<p>The option I use the most, for sending tables to Word or Excel is <code>clipr::write_clip(df)</code>, which writes <code>df</code> to the clipboard for easy pasting. There’s also <code><a href="http://matthewlincoln.net/clipr/reference/write_last_clip.html">clipr::write_last_clip()</a></code> which can be called right after you create a dataframe and copies it to the clipboard.</p>
</section><section id="pretty-but-not-editable" class="level3"><h3 class="anchored" data-anchor-id="pretty-but-not-editable">Pretty but not editable</h3>
<p>Another option is to save a <code>gt</code> as an image or a pdf:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-2_616f4fdad053735409b90803b1568825">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gtsave.html">gtsave</a></span><span class="op">(</span><span class="st">"table.png"</span><span class="op">)</span> <span class="co"># or table.pdf, or whatever</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(Saving as an image requires that <code>webshot2</code> be installed.)</p>
</section>
</div>
</div>
</div>
<section id="flextable" class="level2"><h2 class="anchored" data-anchor-id="flextable"><code>flextable</code></h2>
<p>Piping a dataframe to <code><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable()</a></code> produces a pretty decent initial result:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-3_415929d359642b80ec85801c96ca9084">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">penguins</a></span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">island</span>, <span class="va">bill_length_mm</span>, <span class="va">sex</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># select 5 random rows</span></span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-7d2a07a8{}.cl-7d26b314{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7d28078c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7d280796{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7d2813a8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7d2813a9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7d2813b2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7d2813b3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7d2813b4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7d2813bc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-7d2a07a8">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-7d2813a8"><p class="cl-7d28078c"><span class="cl-7d26b314">species</span></p></th>
<th class="cl-7d2813a8"><p class="cl-7d28078c"><span class="cl-7d26b314">island</span></p></th>
<th class="cl-7d2813a9"><p class="cl-7d280796"><span class="cl-7d26b314">bill_length_mm</span></p></th>
<th class="cl-7d2813a8"><p class="cl-7d28078c"><span class="cl-7d26b314">sex</span></p></th>
<th class="cl-7d2813a9"><p class="cl-7d280796"><span class="cl-7d26b314">year</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">Gentoo</span></p></td>
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">Biscoe</span></p></td>
<td class="cl-7d2813b3"><p class="cl-7d280796"><span class="cl-7d26b314">49.1</span></p></td>
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">male</span></p></td>
<td class="cl-7d2813b3"><p class="cl-7d280796"><span class="cl-7d26b314">2,009</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">Adelie</span></p></td>
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">Dream</span></p></td>
<td class="cl-7d2813b3"><p class="cl-7d280796"><span class="cl-7d26b314">39.5</span></p></td>
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">female</span></p></td>
<td class="cl-7d2813b3"><p class="cl-7d280796"><span class="cl-7d26b314">2,007</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">Chinstrap</span></p></td>
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">Dream</span></p></td>
<td class="cl-7d2813b3"><p class="cl-7d280796"><span class="cl-7d26b314">46.8</span></p></td>
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">female</span></p></td>
<td class="cl-7d2813b3"><p class="cl-7d280796"><span class="cl-7d26b314">2,009</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">Gentoo</span></p></td>
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">Biscoe</span></p></td>
<td class="cl-7d2813b3"><p class="cl-7d280796"><span class="cl-7d26b314">46.8</span></p></td>
<td class="cl-7d2813b2"><p class="cl-7d28078c"><span class="cl-7d26b314">female</span></p></td>
<td class="cl-7d2813b3"><p class="cl-7d280796"><span class="cl-7d26b314">2,009</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-7d2813b4"><p class="cl-7d28078c"><span class="cl-7d26b314">Adelie</span></p></td>
<td class="cl-7d2813b4"><p class="cl-7d28078c"><span class="cl-7d26b314">Biscoe</span></p></td>
<td class="cl-7d2813bc"><p class="cl-7d280796"><span class="cl-7d26b314">40.6</span></p></td>
<td class="cl-7d2813b4"><p class="cl-7d28078c"><span class="cl-7d26b314">male</span></p></td>
<td class="cl-7d2813bc"><p class="cl-7d280796"><span class="cl-7d26b314">2,008</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>While we’re at it, let’s change the formatting of that <code>year</code> column. <code>colformat_num</code> targets numeric columns; the <code>j</code> argument narrows it down to specific columns if needed. <code>colformat_num</code> passes <code>...</code> to <code><a href="https://rdrr.io/r/base/format.html">format()</a></code>, so you can use most <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> arguments—here I’ve just used <code>big.mark</code>.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-4_2c7dcb743a24581be07e10080f838c30">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_1</span> <span class="op">&lt;-</span> <span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">penguins</a></span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">island</span>, <span class="va">bill_length_mm</span>, <span class="va">sex</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/colformat_num.html">colformat_num</a></span><span class="op">(</span>j <span class="op">=</span> <span class="st">"year"</span>, big.mark <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguin_flextable_1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-16cc0cec{}.cl-16c8aeee{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-16ca11ee{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-16ca11f8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-16ca1bbc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-16ca1bc6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-16ca1bc7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-16ca1bc8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-16ca1bc9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-16ca1bd0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-16cc0cec">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-16ca1bbc"><p class="cl-16ca11ee"><span class="cl-16c8aeee">species</span></p></th>
<th class="cl-16ca1bbc"><p class="cl-16ca11ee"><span class="cl-16c8aeee">island</span></p></th>
<th class="cl-16ca1bc6"><p class="cl-16ca11f8"><span class="cl-16c8aeee">bill_length_mm</span></p></th>
<th class="cl-16ca1bbc"><p class="cl-16ca11ee"><span class="cl-16c8aeee">sex</span></p></th>
<th class="cl-16ca1bc6"><p class="cl-16ca11f8"><span class="cl-16c8aeee">year</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Chinstrap</span></p></td>
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Dream</span></p></td>
<td class="cl-16ca1bc8"><p class="cl-16ca11f8"><span class="cl-16c8aeee">49.0</span></p></td>
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">male</span></p></td>
<td class="cl-16ca1bc8"><p class="cl-16ca11f8"><span class="cl-16c8aeee">2008</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Gentoo</span></p></td>
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Biscoe</span></p></td>
<td class="cl-16ca1bc8"><p class="cl-16ca11f8"><span class="cl-16c8aeee">52.2</span></p></td>
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">male</span></p></td>
<td class="cl-16ca1bc8"><p class="cl-16ca11f8"><span class="cl-16c8aeee">2009</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Adelie</span></p></td>
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Dream</span></p></td>
<td class="cl-16ca1bc8"><p class="cl-16ca11f8"><span class="cl-16c8aeee">42.2</span></p></td>
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">female</span></p></td>
<td class="cl-16ca1bc8"><p class="cl-16ca11f8"><span class="cl-16c8aeee">2007</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Gentoo</span></p></td>
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Biscoe</span></p></td>
<td class="cl-16ca1bc8"><p class="cl-16ca11f8"><span class="cl-16c8aeee">50.8</span></p></td>
<td class="cl-16ca1bc7"><p class="cl-16ca11ee"><span class="cl-16c8aeee">male</span></p></td>
<td class="cl-16ca1bc8"><p class="cl-16ca11f8"><span class="cl-16c8aeee">2009</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-16ca1bc9"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Adelie</span></p></td>
<td class="cl-16ca1bc9"><p class="cl-16ca11ee"><span class="cl-16c8aeee">Dream</span></p></td>
<td class="cl-16ca1bd0"><p class="cl-16ca11f8"><span class="cl-16c8aeee">42.3</span></p></td>
<td class="cl-16ca1bc9"><p class="cl-16ca11ee"><span class="cl-16c8aeee">male</span></p></td>
<td class="cl-16ca1bd0"><p class="cl-16ca11f8"><span class="cl-16c8aeee">2007</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You can also format columns with a function using <code><a href="https://davidgohel.github.io/flextable/reference/set_formatter.html">set_formatter()</a></code>. We could, for example, make the <code>species</code> column lowercase and the <code>island</code> column uppercase:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-5_f6d0c791c17d91afb9c6c777ea523d28">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_formatter.html">set_formatter</a></span><span class="op">(</span>species <span class="op">=</span> <span class="va">tolower</span>, island <span class="op">=</span> <span class="va">toupper</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-72532cc2{}.cl-724f5ca0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-72510a8c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-72510a8d{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-72511496{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-72511497{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-72511498{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-725114a0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-725114a1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-725114aa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-72532cc2">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-72511496"><p class="cl-72510a8c"><span class="cl-724f5ca0">species</span></p></th>
<th class="cl-72511496"><p class="cl-72510a8c"><span class="cl-724f5ca0">island</span></p></th>
<th class="cl-72511497"><p class="cl-72510a8d"><span class="cl-724f5ca0">bill_length_mm</span></p></th>
<th class="cl-72511496"><p class="cl-72510a8c"><span class="cl-724f5ca0">sex</span></p></th>
<th class="cl-72511497"><p class="cl-72510a8d"><span class="cl-724f5ca0">year</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">chinstrap</span></p></td>
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">DREAM</span></p></td>
<td class="cl-725114a0"><p class="cl-72510a8d"><span class="cl-724f5ca0">49.0</span></p></td>
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">male</span></p></td>
<td class="cl-725114a0"><p class="cl-72510a8d"><span class="cl-724f5ca0">2008</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">gentoo</span></p></td>
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">BISCOE</span></p></td>
<td class="cl-725114a0"><p class="cl-72510a8d"><span class="cl-724f5ca0">52.2</span></p></td>
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">male</span></p></td>
<td class="cl-725114a0"><p class="cl-72510a8d"><span class="cl-724f5ca0">2009</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">adelie</span></p></td>
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">DREAM</span></p></td>
<td class="cl-725114a0"><p class="cl-72510a8d"><span class="cl-724f5ca0">42.2</span></p></td>
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">female</span></p></td>
<td class="cl-725114a0"><p class="cl-72510a8d"><span class="cl-724f5ca0">2007</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">gentoo</span></p></td>
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">BISCOE</span></p></td>
<td class="cl-725114a0"><p class="cl-72510a8d"><span class="cl-724f5ca0">50.8</span></p></td>
<td class="cl-72511498"><p class="cl-72510a8c"><span class="cl-724f5ca0">male</span></p></td>
<td class="cl-725114a0"><p class="cl-72510a8d"><span class="cl-724f5ca0">2009</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-725114a1"><p class="cl-72510a8c"><span class="cl-724f5ca0">adelie</span></p></td>
<td class="cl-725114a1"><p class="cl-72510a8c"><span class="cl-724f5ca0">DREAM</span></p></td>
<td class="cl-725114aa"><p class="cl-72510a8d"><span class="cl-724f5ca0">42.3</span></p></td>
<td class="cl-725114a1"><p class="cl-72510a8c"><span class="cl-724f5ca0">male</span></p></td>
<td class="cl-725114aa"><p class="cl-72510a8d"><span class="cl-724f5ca0">2007</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You can also pass a anonymous function if you need to specify arguments:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-6_f434c4241fec5a5c1db51d9cdd449f03">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_formatter.html">set_formatter</a></span><span class="op">(</span>sex <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"male"</span>, <span class="st">"m"</span>, <span class="st">"f"</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-7261dd94{}.cl-725ecba4{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-725ff538{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-725ff542{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-725ffe70{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-725ffe7a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-725ffe7b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-725ffe7c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-725ffe7d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-725ffe84{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-7261dd94">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-725ffe70"><p class="cl-725ff538"><span class="cl-725ecba4">species</span></p></th>
<th class="cl-725ffe70"><p class="cl-725ff538"><span class="cl-725ecba4">island</span></p></th>
<th class="cl-725ffe7a"><p class="cl-725ff542"><span class="cl-725ecba4">bill_length_mm</span></p></th>
<th class="cl-725ffe70"><p class="cl-725ff538"><span class="cl-725ecba4">sex</span></p></th>
<th class="cl-725ffe7a"><p class="cl-725ff542"><span class="cl-725ecba4">year</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">Chinstrap</span></p></td>
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">Dream</span></p></td>
<td class="cl-725ffe7c"><p class="cl-725ff542"><span class="cl-725ecba4">49.0</span></p></td>
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">m</span></p></td>
<td class="cl-725ffe7c"><p class="cl-725ff542"><span class="cl-725ecba4">2008</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">Gentoo</span></p></td>
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">Biscoe</span></p></td>
<td class="cl-725ffe7c"><p class="cl-725ff542"><span class="cl-725ecba4">52.2</span></p></td>
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">m</span></p></td>
<td class="cl-725ffe7c"><p class="cl-725ff542"><span class="cl-725ecba4">2009</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">Adelie</span></p></td>
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">Dream</span></p></td>
<td class="cl-725ffe7c"><p class="cl-725ff542"><span class="cl-725ecba4">42.2</span></p></td>
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">f</span></p></td>
<td class="cl-725ffe7c"><p class="cl-725ff542"><span class="cl-725ecba4">2007</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">Gentoo</span></p></td>
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">Biscoe</span></p></td>
<td class="cl-725ffe7c"><p class="cl-725ff542"><span class="cl-725ecba4">50.8</span></p></td>
<td class="cl-725ffe7b"><p class="cl-725ff538"><span class="cl-725ecba4">m</span></p></td>
<td class="cl-725ffe7c"><p class="cl-725ff542"><span class="cl-725ecba4">2009</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-725ffe7d"><p class="cl-725ff538"><span class="cl-725ecba4">Adelie</span></p></td>
<td class="cl-725ffe7d"><p class="cl-725ff538"><span class="cl-725ecba4">Dream</span></p></td>
<td class="cl-725ffe84"><p class="cl-725ff542"><span class="cl-725ecba4">42.3</span></p></td>
<td class="cl-725ffe7d"><p class="cl-725ff538"><span class="cl-725ecba4">m</span></p></td>
<td class="cl-725ffe84"><p class="cl-725ff542"><span class="cl-725ecba4">2007</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>A particularly good use of this is using one of the labeller functions from <code>scales</code>, e.g.&nbsp;if you want to format currency:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-7_74bd0fd1f5da3828583d640040e89b38">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12.1</span>, <span class="fl">21.56</span>, <span class="fl">3.64</span><span class="op">)</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">44.0</span>, <span class="fl">54.44</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_formatter.html">set_formatter</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/dollar_format.html">label_dollar</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-6e298ada{}.cl-6e25e1a0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6e278244{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e278ed8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e278ed9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e278ee2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6e298ada">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-6e278ed8"><p class="cl-6e278244"><span class="cl-6e25e1a0">A</span></p></th>
<th class="cl-6e278ed8"><p class="cl-6e278244"><span class="cl-6e25e1a0">B</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e278ed9"><p class="cl-6e278244"><span class="cl-6e25e1a0">$12.10</span></p></td>
<td class="cl-6e278ed9"><p class="cl-6e278244"><span class="cl-6e25e1a0">44.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e278ed9"><p class="cl-6e278244"><span class="cl-6e25e1a0">$21.56</span></p></td>
<td class="cl-6e278ed9"><p class="cl-6e278244"><span class="cl-6e25e1a0">54.44</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e278ee2"><p class="cl-6e278244"><span class="cl-6e25e1a0">$3.64</span></p></td>
<td class="cl-6e278ee2"><p class="cl-6e278244"><span class="cl-6e25e1a0">6.00</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="multiple-heading-levelsgrouping" class="level3"><h3 class="anchored" data-anchor-id="multiple-heading-levelsgrouping">Multiple heading levels/grouping</h3>
<p>You can also make fairly nice tables with a grouping structure in the header using <code><a href="https://davidgohel.github.io/flextable/reference/separate_header.html">separate_header()</a></code>. This function will interpret column names with a separator (e.g.&nbsp;“_” as groups and sub-groups.</p>
<p>Consider the following (unremarkable) dataframe which summarizes penguin bill length by <code>species</code> and <code>sex</code>:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-8_35ce7332206388a0c0f180a290487905">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_data</span> <span class="op">&lt;-</span> <span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">penguins</a></span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">sex</span>, <span class="va">bill_length_mm</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">sex</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>bill.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguin_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">species</th>
<th style="text-align: left;">sex</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">bill.length</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">36.51600</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gentoo</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">46.26000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chinstrap</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">46.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gentoo</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">48.53913</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chinstrap</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">51.10000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Let’s pipe that into <code>flextable</code>, repeat the <code>year</code> column formatting from before, and also round the <code>bill.length</code> column to 2 digits.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-9_a2ab1e8f468e72b4e2cd1eba640e0ce1">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_2</span> <span class="op">&lt;-</span> <span class="va">penguin_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/colformat_num.html">colformat_num</a></span><span class="op">(</span>j <span class="op">=</span> <span class="st">"year"</span>, big.mark <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/colformat_double.html">colformat_double</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguin_flextable_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-6e4e94b0{}.cl-6e4b7e56{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6e4cbe38{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e4cbe60{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e4cc680{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e4cc681{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e4cc68a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e4cc68b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e4cc68c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e4cc694{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6e4e94b0">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-6e4cc680"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">species</span></p></th>
<th class="cl-6e4cc680"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">sex</span></p></th>
<th class="cl-6e4cc681"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">year</span></p></th>
<th class="cl-6e4cc681"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">bill.length</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e4cc68a"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">Chinstrap</span></p></td>
<td class="cl-6e4cc68a"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">male</span></p></td>
<td class="cl-6e4cc68b"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">2008</span></p></td>
<td class="cl-6e4cc68b"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">51.40</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e4cc68a"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">Gentoo</span></p></td>
<td class="cl-6e4cc68a"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">female</span></p></td>
<td class="cl-6e4cc68b"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">2009</span></p></td>
<td class="cl-6e4cc68b"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">46.26</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e4cc68a"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">Chinstrap</span></p></td>
<td class="cl-6e4cc68a"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">female</span></p></td>
<td class="cl-6e4cc68b"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">2009</span></p></td>
<td class="cl-6e4cc68b"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">47.01</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e4cc68a"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">Gentoo</span></p></td>
<td class="cl-6e4cc68a"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">male</span></p></td>
<td class="cl-6e4cc68b"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">2007</span></p></td>
<td class="cl-6e4cc68b"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e4cc68c"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">Chinstrap</span></p></td>
<td class="cl-6e4cc68c"><p class="cl-6e4cbe38"><span class="cl-6e4b7e56">female</span></p></td>
<td class="cl-6e4cc694"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">2008</span></p></td>
<td class="cl-6e4cc694"><p class="cl-6e4cbe60"><span class="cl-6e4b7e56">46.00</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can make this a lot easier to read if we have species and island as header rows. We’ll start by <code>pivot_wider</code>-ing these two columns. Note that <code>pivot_wider</code> defaults to combining <code>species</code> and <code>island</code> with an underscore (this becomes important momentarily):</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-10_26d88fe3d4a991c9d8ee46d3416739bf">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_3</span> <span class="op">&lt;-</span> <span class="va">penguin_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"sex"</span><span class="op">)</span>, values_from <span class="op">=</span> <span class="st">"bill.length"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/colformat_num.html">colformat_num</a></span><span class="op">(</span>j <span class="op">=</span> <span class="st">"year"</span>, big.mark <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># reapply our formatting from before</span></span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/colformat_double.html">colformat_double</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguin_flextable_3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-6e61e9fc{}.cl-6e5ec830{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6e601f78{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e602748{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e602752{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e602753{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6e61e9fc">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-6e602748"><p class="cl-6e601f78"><span class="cl-6e5ec830">year</span></p></th>
<th class="cl-6e602748"><p class="cl-6e601f78"><span class="cl-6e5ec830">Adelie_female</span></p></th>
<th class="cl-6e602748"><p class="cl-6e601f78"><span class="cl-6e5ec830">Adelie_male</span></p></th>
<th class="cl-6e602748"><p class="cl-6e601f78"><span class="cl-6e5ec830">Chinstrap_female</span></p></th>
<th class="cl-6e602748"><p class="cl-6e601f78"><span class="cl-6e5ec830">Chinstrap_male</span></p></th>
<th class="cl-6e602748"><p class="cl-6e601f78"><span class="cl-6e5ec830">Gentoo_female</span></p></th>
<th class="cl-6e602748"><p class="cl-6e601f78"><span class="cl-6e5ec830">Gentoo_male</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">2007</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">37.92</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">39.95</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">46.57</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">50.88</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">45.06</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">2008</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">36.52</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">40.60</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">46.00</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">51.40</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">45.30</span></p></td>
<td class="cl-6e602752"><p class="cl-6e601f78"><span class="cl-6e5ec830">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e602753"><p class="cl-6e601f78"><span class="cl-6e5ec830">2009</span></p></td>
<td class="cl-6e602753"><p class="cl-6e601f78"><span class="cl-6e5ec830">37.41</span></p></td>
<td class="cl-6e602753"><p class="cl-6e601f78"><span class="cl-6e5ec830">40.56</span></p></td>
<td class="cl-6e602753"><p class="cl-6e601f78"><span class="cl-6e5ec830">47.01</span></p></td>
<td class="cl-6e602753"><p class="cl-6e601f78"><span class="cl-6e5ec830">51.10</span></p></td>
<td class="cl-6e602753"><p class="cl-6e601f78"><span class="cl-6e5ec830">46.26</span></p></td>
<td class="cl-6e602753"><p class="cl-6e601f78"><span class="cl-6e5ec830">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><code><a href="https://davidgohel.github.io/flextable/reference/separate_header.html">separate_header()</a></code> parses the column names using the underscore, and makes two header levels:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-11_18a495bb65bda38be594534b856a24c5">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">&lt;-</span> <span class="va">penguin_flextable_3</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/separate_header.html">separate_header</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguin_flextable_4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-6e716f26{}.cl-6e6ddb36{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6e6f88f0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e6f88fa{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e6f8904{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e6f9192{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e6f919c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e6f919d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e6f919e{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e6f91a6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e6f91a7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e6f91a8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6e716f26">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-6e6f9192"><p class="cl-6e6f88f0"><span class="cl-6e6ddb36">year</span></p></th>
<th colspan="2" class="cl-6e6f919c"><p class="cl-6e6f88fa"><span class="cl-6e6ddb36">Adelie</span></p></th>
<th colspan="2" class="cl-6e6f919c"><p class="cl-6e6f88fa"><span class="cl-6e6ddb36">Chinstrap</span></p></th>
<th colspan="2" class="cl-6e6f919c"><p class="cl-6e6f88fa"><span class="cl-6e6ddb36">Gentoo</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6e6f91a6"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">female</span></p></th>
<th class="cl-6e6f91a6"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">male</span></p></th>
<th class="cl-6e6f91a6"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">female</span></p></th>
<th class="cl-6e6f91a6"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">male</span></p></th>
<th class="cl-6e6f91a6"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">female</span></p></th>
<th class="cl-6e6f91a6"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">male</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">2007</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">37.92</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">39.95</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">46.57</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">50.88</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">45.06</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">2008</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">36.52</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">40.60</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">46.00</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">51.40</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">45.30</span></p></td>
<td class="cl-6e6f91a7"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e6f91a8"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">2009</span></p></td>
<td class="cl-6e6f91a8"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">37.41</span></p></td>
<td class="cl-6e6f91a8"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">40.56</span></p></td>
<td class="cl-6e6f91a8"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">47.01</span></p></td>
<td class="cl-6e6f91a8"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">51.10</span></p></td>
<td class="cl-6e6f91a8"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">46.26</span></p></td>
<td class="cl-6e6f91a8"><p class="cl-6e6f8904"><span class="cl-6e6ddb36">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You can change separator with `separate_header(…, split = “…regex…”). This is useful if your variable names already use underscore as a separator.</p>
<p>Note that since in the combined column names, <code>species</code> comes before <code>sex</code> (e.g.&nbsp;<code>Adelie_male</code>), it’s been used as the top header row. If you switch the order of the <code>names_from</code> argument in <code>pivot_wider</code>, you get <code>sex</code> as the top row. This gives a slightly unexpected result: why are female/male repeated across each category?</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-12_b222db54dbc72aec5b566121329a5c46">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"species"</span><span class="op">)</span>, values_from <span class="op">=</span> <span class="st">"bill.length"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/separate_header.html">separate_header</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/colformat_num.html">colformat_num</a></span><span class="op">(</span>j <span class="op">=</span> <span class="st">"year"</span>, big.mark <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># reapply our formatting from before</span></span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/colformat_double.html">colformat_double</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-6e851f12{}.cl-6e824076{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6e836e38{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e836e42{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e83763a{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e837644{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e837645{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e837646{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e83764e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e83764f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6e851f12">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-6e83763a"><p class="cl-6e836e38"><span class="cl-6e824076">year</span></p></th>
<th class="cl-6e837644"><p class="cl-6e836e42"><span class="cl-6e824076">female</span></p></th>
<th class="cl-6e837644"><p class="cl-6e836e42"><span class="cl-6e824076">male</span></p></th>
<th class="cl-6e837644"><p class="cl-6e836e42"><span class="cl-6e824076">female</span></p></th>
<th class="cl-6e837644"><p class="cl-6e836e42"><span class="cl-6e824076">male</span></p></th>
<th class="cl-6e837644"><p class="cl-6e836e42"><span class="cl-6e824076">female</span></p></th>
<th class="cl-6e837644"><p class="cl-6e836e42"><span class="cl-6e824076">male</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6e837646"><p class="cl-6e836e42"><span class="cl-6e824076">Adelie</span></p></th>
<th class="cl-6e837646"><p class="cl-6e836e42"><span class="cl-6e824076">Adelie</span></p></th>
<th class="cl-6e837646"><p class="cl-6e836e42"><span class="cl-6e824076">Chinstrap</span></p></th>
<th class="cl-6e837646"><p class="cl-6e836e42"><span class="cl-6e824076">Chinstrap</span></p></th>
<th class="cl-6e837646"><p class="cl-6e836e42"><span class="cl-6e824076">Gentoo</span></p></th>
<th class="cl-6e837646"><p class="cl-6e836e42"><span class="cl-6e824076">Gentoo</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">2007</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">37.92</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">39.95</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">46.57</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">50.88</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">45.06</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">2008</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">36.52</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">40.60</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">46.00</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">51.40</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">45.30</span></p></td>
<td class="cl-6e83764e"><p class="cl-6e836e42"><span class="cl-6e824076">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e83764f"><p class="cl-6e836e42"><span class="cl-6e824076">2009</span></p></td>
<td class="cl-6e83764f"><p class="cl-6e836e42"><span class="cl-6e824076">37.41</span></p></td>
<td class="cl-6e83764f"><p class="cl-6e836e42"><span class="cl-6e824076">40.56</span></p></td>
<td class="cl-6e83764f"><p class="cl-6e836e42"><span class="cl-6e824076">47.01</span></p></td>
<td class="cl-6e83764f"><p class="cl-6e836e42"><span class="cl-6e824076">51.10</span></p></td>
<td class="cl-6e83764f"><p class="cl-6e836e42"><span class="cl-6e824076">46.26</span></p></td>
<td class="cl-6e83764f"><p class="cl-6e836e42"><span class="cl-6e824076">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><code><a href="https://davidgohel.github.io/flextable/reference/separate_header.html">separate_header()</a></code> doesn’t rearrange columns to put relevant groups next to each other. If you want a spanning column, you’ll need to reorder the columns manually with <code><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate()</a></code>:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-13_037a7e5490e1d3bf6c2fcaa57fad599e">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"species"</span><span class="op">)</span>, values_from <span class="op">=</span> <span class="st">"bill.length"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"female"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/separate_header.html">separate_header</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/colformat_num.html">colformat_num</a></span><span class="op">(</span>j <span class="op">=</span> <span class="st">"year"</span>, big.mark <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># reapply our formatting from before</span></span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/colformat_double.html">colformat_double</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-6e9a6fb6{}.cl-6e973378{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6e98c51c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e98c51d{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e98c526{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6e98ccce{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e98ccd8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e98ccd9{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e98ccda{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e98cce2{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e98cce3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6e98cce4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6e9a6fb6">
<thead>
<tr style="overflow-wrap:break-word;">
<th colspan="3" class="cl-6e98ccce"><p class="cl-6e98c51c"><span class="cl-6e973378">female</span></p></th>
<th rowspan="2" class="cl-6e98ccd9"><p class="cl-6e98c526"><span class="cl-6e973378">year</span></p></th>
<th colspan="3" class="cl-6e98ccce"><p class="cl-6e98c51c"><span class="cl-6e973378">male</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6e98ccda"><p class="cl-6e98c51d"><span class="cl-6e973378">Adelie</span></p></th>
<th class="cl-6e98ccda"><p class="cl-6e98c51d"><span class="cl-6e973378">Chinstrap</span></p></th>
<th class="cl-6e98ccda"><p class="cl-6e98c51d"><span class="cl-6e973378">Gentoo</span></p></th>
<th class="cl-6e98ccda"><p class="cl-6e98c51d"><span class="cl-6e973378">Adelie</span></p></th>
<th class="cl-6e98ccda"><p class="cl-6e98c51d"><span class="cl-6e973378">Chinstrap</span></p></th>
<th class="cl-6e98ccda"><p class="cl-6e98c51d"><span class="cl-6e973378">Gentoo</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">37.92</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">46.57</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">45.06</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">2007</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">39.95</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">50.88</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">36.52</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">46.00</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">45.30</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">2008</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">40.60</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">51.40</span></p></td>
<td class="cl-6e98cce3"><p class="cl-6e98c51d"><span class="cl-6e973378">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6e98cce4"><p class="cl-6e98c51d"><span class="cl-6e973378">37.41</span></p></td>
<td class="cl-6e98cce4"><p class="cl-6e98c51d"><span class="cl-6e973378">47.01</span></p></td>
<td class="cl-6e98cce4"><p class="cl-6e98c51d"><span class="cl-6e973378">46.26</span></p></td>
<td class="cl-6e98cce4"><p class="cl-6e98c51d"><span class="cl-6e973378">2009</span></p></td>
<td class="cl-6e98cce4"><p class="cl-6e98c51d"><span class="cl-6e973378">40.56</span></p></td>
<td class="cl-6e98cce4"><p class="cl-6e98c51d"><span class="cl-6e973378">51.10</span></p></td>
<td class="cl-6e98cce4"><p class="cl-6e98c51d"><span class="cl-6e973378">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>With savvy use of <code>pivot_wider(names_from = ...)</code> combined with <code>relocate</code>, you can the ordering of header rows and spanning columns you’re after.</p>
</section><section id="change-labels" class="level3"><h3 class="anchored" data-anchor-id="change-labels">Change labels</h3>
<p>We can edit text/values with <code><a href="https://davidgohel.github.io/flextable/reference/labelizor.html">labelizor()</a></code>. The example below changes all instances of female/male to f/m:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-14_770566dd03fd8e036a45814405e227eb">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/labelizor.html">labelizor</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"female"</span> <span class="op">=</span> <span class="st">"f"</span>, <span class="st">"male"</span> <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-6ea9e46e{}.cl-6ea6d530{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6ea812f6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ea8130a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ea8130b{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ea81ecc{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ea81ecd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ea81ece{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ea81ed6{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ea81ed7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ea81ee0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6ea81ee1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6ea9e46e">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-6ea81ecc"><p class="cl-6ea812f6"><span class="cl-6ea6d530">year</span></p></th>
<th colspan="2" class="cl-6ea81ecd"><p class="cl-6ea8130a"><span class="cl-6ea6d530">Adelie</span></p></th>
<th colspan="2" class="cl-6ea81ecd"><p class="cl-6ea8130a"><span class="cl-6ea6d530">Chinstrap</span></p></th>
<th colspan="2" class="cl-6ea81ecd"><p class="cl-6ea8130a"><span class="cl-6ea6d530">Gentoo</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6ea81ed7"><p class="cl-6ea8130b"><span class="cl-6ea6d530">f</span></p></th>
<th class="cl-6ea81ed7"><p class="cl-6ea8130b"><span class="cl-6ea6d530">m</span></p></th>
<th class="cl-6ea81ed7"><p class="cl-6ea8130b"><span class="cl-6ea6d530">f</span></p></th>
<th class="cl-6ea81ed7"><p class="cl-6ea8130b"><span class="cl-6ea6d530">m</span></p></th>
<th class="cl-6ea81ed7"><p class="cl-6ea8130b"><span class="cl-6ea6d530">f</span></p></th>
<th class="cl-6ea81ed7"><p class="cl-6ea8130b"><span class="cl-6ea6d530">m</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">2007</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">37.92</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">39.95</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">46.57</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">50.88</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">45.06</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">2008</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">36.52</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">40.60</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">46.00</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">51.40</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">45.30</span></p></td>
<td class="cl-6ea81ee0"><p class="cl-6ea8130b"><span class="cl-6ea6d530">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6ea81ee1"><p class="cl-6ea8130b"><span class="cl-6ea6d530">2009</span></p></td>
<td class="cl-6ea81ee1"><p class="cl-6ea8130b"><span class="cl-6ea6d530">37.41</span></p></td>
<td class="cl-6ea81ee1"><p class="cl-6ea8130b"><span class="cl-6ea6d530">40.56</span></p></td>
<td class="cl-6ea81ee1"><p class="cl-6ea8130b"><span class="cl-6ea6d530">47.01</span></p></td>
<td class="cl-6ea81ee1"><p class="cl-6ea8130b"><span class="cl-6ea6d530">51.10</span></p></td>
<td class="cl-6ea81ee1"><p class="cl-6ea8130b"><span class="cl-6ea6d530">46.26</span></p></td>
<td class="cl-6ea81ee1"><p class="cl-6ea8130b"><span class="cl-6ea6d530">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Adding the <code>j</code> argument selects columns to restrict the changes to:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-15_a34603f605eeda6dbd05823efea9532a">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/labelizor.html">labelizor</a></span><span class="op">(</span>j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adelie_female"</span>, <span class="st">"Chinstrap_female"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"female"</span> <span class="op">=</span> <span class="st">"f"</span>, <span class="st">"male"</span> <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-6eb6d962{}.cl-6eb3617e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6eb50614{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6eb5061e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6eb50628{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6eb50efc{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6eb50efd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6eb50efe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6eb50f06{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6eb50f07{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6eb50f08{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6eb50f09{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-6eb6d962">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-6eb50efc"><p class="cl-6eb50614"><span class="cl-6eb3617e">year</span></p></th>
<th colspan="2" class="cl-6eb50efd"><p class="cl-6eb5061e"><span class="cl-6eb3617e">Adelie</span></p></th>
<th colspan="2" class="cl-6eb50efd"><p class="cl-6eb5061e"><span class="cl-6eb3617e">Chinstrap</span></p></th>
<th colspan="2" class="cl-6eb50efd"><p class="cl-6eb5061e"><span class="cl-6eb3617e">Gentoo</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-6eb50f07"><p class="cl-6eb50628"><span class="cl-6eb3617e">f</span></p></th>
<th class="cl-6eb50f07"><p class="cl-6eb50628"><span class="cl-6eb3617e">male</span></p></th>
<th class="cl-6eb50f07"><p class="cl-6eb50628"><span class="cl-6eb3617e">f</span></p></th>
<th class="cl-6eb50f07"><p class="cl-6eb50628"><span class="cl-6eb3617e">male</span></p></th>
<th class="cl-6eb50f07"><p class="cl-6eb50628"><span class="cl-6eb3617e">female</span></p></th>
<th class="cl-6eb50f07"><p class="cl-6eb50628"><span class="cl-6eb3617e">male</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">2007</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">37.92</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">39.95</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">46.57</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">50.88</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">45.06</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">2008</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">36.52</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">40.60</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">46.00</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">51.40</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">45.30</span></p></td>
<td class="cl-6eb50f08"><p class="cl-6eb50628"><span class="cl-6eb3617e">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-6eb50f09"><p class="cl-6eb50628"><span class="cl-6eb3617e">2009</span></p></td>
<td class="cl-6eb50f09"><p class="cl-6eb50628"><span class="cl-6eb3617e">37.41</span></p></td>
<td class="cl-6eb50f09"><p class="cl-6eb50628"><span class="cl-6eb3617e">40.56</span></p></td>
<td class="cl-6eb50f09"><p class="cl-6eb50628"><span class="cl-6eb3617e">47.01</span></p></td>
<td class="cl-6eb50f09"><p class="cl-6eb50628"><span class="cl-6eb3617e">51.10</span></p></td>
<td class="cl-6eb50f09"><p class="cl-6eb50628"><span class="cl-6eb3617e">46.26</span></p></td>
<td class="cl-6eb50f09"><p class="cl-6eb50628"><span class="cl-6eb3617e">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Note that for the <code>j</code> argument, the rownames are based on the underlying <code>df</code>, not what you seen in the flextable. That’s why I have to refer to <code>Adelie_female</code>, which was one of the columns that resulted from out <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>ing. You can do a lot with <code>j</code> (and in other functions that support it, <code>i</code> for rows), including using logical expressions to filter columns. <a href="https://ardata-fr.github.io/flextable-book/table-design.html#usage">See here</a> for more details. The <code>labels</code> argument takes name-value pairs where the name is the value to replace and the value is the replacement value.</p>
</section><section id="conditional-formatting" class="level3"><h3 class="anchored" data-anchor-id="conditional-formatting">Conditional formatting</h3>
<p>You can target cells with specific values for various kinds of formatting. For example, <code><a href="https://davidgohel.github.io/flextable/reference/color.html">color()</a></code> sets the text color. The <code>color</code> argument takes either a vector of colors or a function which returns a vector of colors—here I’ve just used an anonymous function to color code based on whether a value is below or above 40:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-16_e29c45194f0902a1a0f53b6fd1aa10ea">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/color.html">color</a></span><span class="op">(</span>color <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">40</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-8af13e62{}.cl-8aedbf9e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8aedbfa8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-8aef3522{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8aef352c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8aef352d{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8aef3fa4{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8aef3fa5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8aef3fae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8aef3faf{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8aef3fb0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8aef3fb8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8aef3fb9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-8af13e62">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-8aef3fa4"><p class="cl-8aef3522"><span class="cl-8aedbf9e">year</span></p></th>
<th colspan="2" class="cl-8aef3fa5"><p class="cl-8aef352c"><span class="cl-8aedbf9e">Adelie</span></p></th>
<th colspan="2" class="cl-8aef3fa5"><p class="cl-8aef352c"><span class="cl-8aedbf9e">Chinstrap</span></p></th>
<th colspan="2" class="cl-8aef3fa5"><p class="cl-8aef352c"><span class="cl-8aedbf9e">Gentoo</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-8aef3fb0"><p class="cl-8aef352d"><span class="cl-8aedbf9e">female</span></p></th>
<th class="cl-8aef3fb0"><p class="cl-8aef352d"><span class="cl-8aedbf9e">male</span></p></th>
<th class="cl-8aef3fb0"><p class="cl-8aef352d"><span class="cl-8aedbf9e">female</span></p></th>
<th class="cl-8aef3fb0"><p class="cl-8aef352d"><span class="cl-8aedbf9e">male</span></p></th>
<th class="cl-8aef3fb0"><p class="cl-8aef352d"><span class="cl-8aedbf9e">female</span></p></th>
<th class="cl-8aef3fb0"><p class="cl-8aef352d"><span class="cl-8aedbf9e">male</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">2007</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbfa8">37.92</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbfa8">39.95</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">46.57</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">50.88</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">45.06</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">2008</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbfa8">36.52</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">40.60</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">46.00</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">51.40</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">45.30</span></p></td>
<td class="cl-8aef3fb8"><p class="cl-8aef352d"><span class="cl-8aedbf9e">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8aef3fb9"><p class="cl-8aef352d"><span class="cl-8aedbf9e">2009</span></p></td>
<td class="cl-8aef3fb9"><p class="cl-8aef352d"><span class="cl-8aedbfa8">37.41</span></p></td>
<td class="cl-8aef3fb9"><p class="cl-8aef352d"><span class="cl-8aedbf9e">40.56</span></p></td>
<td class="cl-8aef3fb9"><p class="cl-8aef352d"><span class="cl-8aedbf9e">47.01</span></p></td>
<td class="cl-8aef3fb9"><p class="cl-8aef352d"><span class="cl-8aedbf9e">51.10</span></p></td>
<td class="cl-8aef3fb9"><p class="cl-8aef352d"><span class="cl-8aedbf9e">46.26</span></p></td>
<td class="cl-8aef3fb9"><p class="cl-8aef352d"><span class="cl-8aedbf9e">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You can get more fancy and use a scale from the <code>scales</code> package:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-17_fc28493e9afd0ed3d5e77ef42f89a5ba">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/color.html">color</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/col_numeric.html">col_numeric</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"viridis"</span>, domain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">52</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some values were outside the color scale and will be treated as NA</code></pre>
</div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-8b02c3da{}.cl-8affcb08{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8affcb12{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(128, 128, 128, 1.00);background-color:transparent;}.cl-8affcb13{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(46, 111, 142, 1.00);background-color:transparent;}.cl-8affcb14{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(37, 132, 142, 1.00);background-color:transparent;}.cl-8affcb1c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(94, 201, 98, 1.00);background-color:transparent;}.cl-8affcb1d{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(221, 227, 24, 1.00);background-color:transparent;}.cl-8affcb1e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(60, 188, 116, 1.00);background-color:transparent;}.cl-8affcb26{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(163, 218, 55, 1.00);background-color:transparent;}.cl-8affcb27{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(53, 95, 141, 1.00);background-color:transparent;}.cl-8affcb30{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(34, 140, 141, 1.00);background-color:transparent;}.cl-8affcb31{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(81, 196, 106, 1.00);background-color:transparent;}.cl-8affcb32{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(236, 229, 27, 1.00);background-color:transparent;}.cl-8affcb3a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(65, 189, 114, 1.00);background-color:transparent;}.cl-8affcb3b{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(149, 216, 64, 1.00);background-color:transparent;}.cl-8affcb3c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(48, 105, 142, 1.00);background-color:transparent;}.cl-8affcb3d{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(34, 139, 141, 1.00);background-color:transparent;}.cl-8affcb44{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(105, 205, 91, 1.00);background-color:transparent;}.cl-8affcb45{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(228, 228, 25, 1.00);background-color:transparent;}.cl-8affcb46{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(87, 198, 102, 1.00);background-color:transparent;}.cl-8b00f97e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b00f988{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b00f992{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b010220{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b01022a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b01022b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b01022c{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b01022d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b010234{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b010235{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-8b02c3da">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-8b010220"><p class="cl-8b00f97e"><span class="cl-8affcb08">year</span></p></th>
<th colspan="2" class="cl-8b01022a"><p class="cl-8b00f988"><span class="cl-8affcb08">Adelie</span></p></th>
<th colspan="2" class="cl-8b01022a"><p class="cl-8b00f988"><span class="cl-8affcb08">Chinstrap</span></p></th>
<th colspan="2" class="cl-8b01022a"><p class="cl-8b00f988"><span class="cl-8affcb08">Gentoo</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-8b01022d"><p class="cl-8b00f992"><span class="cl-8affcb08">female</span></p></th>
<th class="cl-8b01022d"><p class="cl-8b00f992"><span class="cl-8affcb08">male</span></p></th>
<th class="cl-8b01022d"><p class="cl-8b00f992"><span class="cl-8affcb08">female</span></p></th>
<th class="cl-8b01022d"><p class="cl-8b00f992"><span class="cl-8affcb08">male</span></p></th>
<th class="cl-8b01022d"><p class="cl-8b00f992"><span class="cl-8affcb08">female</span></p></th>
<th class="cl-8b01022d"><p class="cl-8b00f992"><span class="cl-8affcb08">male</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb12">2007</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb13">37.92</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb14">39.95</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb1c">46.57</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb1d">50.88</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb1e">45.06</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb26">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb12">2008</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb27">36.52</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb30">40.60</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb31">46.00</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb32">51.40</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb3a">45.30</span></p></td>
<td class="cl-8b010234"><p class="cl-8b00f992"><span class="cl-8affcb3b">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b010235"><p class="cl-8b00f992"><span class="cl-8affcb12">2009</span></p></td>
<td class="cl-8b010235"><p class="cl-8b00f992"><span class="cl-8affcb3c">37.41</span></p></td>
<td class="cl-8b010235"><p class="cl-8b00f992"><span class="cl-8affcb3d">40.56</span></p></td>
<td class="cl-8b010235"><p class="cl-8b00f992"><span class="cl-8affcb44">47.01</span></p></td>
<td class="cl-8b010235"><p class="cl-8b00f992"><span class="cl-8affcb45">51.10</span></p></td>
<td class="cl-8b010235"><p class="cl-8b00f992"><span class="cl-8affcb46">46.26</span></p></td>
<td class="cl-8b010235"><p class="cl-8b00f992"><span class="cl-8affcb1d">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/color.html">color</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/col_numeric.html">col_bin</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"viridis"</span>, domain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some values were outside the color scale and will be treated as NA</code></pre>
</div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-8b09f9f2{}.cl-8b067002{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8b06700c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(128, 128, 128, 1.00);background-color:transparent;}.cl-8b06700d{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(68, 1, 84, 1.00);background-color:transparent;}.cl-8b067016{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(33, 144, 141, 1.00);background-color:transparent;}.cl-8b067017{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(253, 231, 37, 1.00);background-color:transparent;}.cl-8b07b11a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b07b11b{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b07b124{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b07ba02{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b07ba03{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b07ba0c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b07ba0d{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b07ba0e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b07ba16{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b07ba17{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-8b09f9f2">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-8b07ba02"><p class="cl-8b07b11a"><span class="cl-8b067002">year</span></p></th>
<th colspan="2" class="cl-8b07ba03"><p class="cl-8b07b11b"><span class="cl-8b067002">Adelie</span></p></th>
<th colspan="2" class="cl-8b07ba03"><p class="cl-8b07b11b"><span class="cl-8b067002">Chinstrap</span></p></th>
<th colspan="2" class="cl-8b07ba03"><p class="cl-8b07b11b"><span class="cl-8b067002">Gentoo</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-8b07ba0e"><p class="cl-8b07b124"><span class="cl-8b067002">female</span></p></th>
<th class="cl-8b07ba0e"><p class="cl-8b07b124"><span class="cl-8b067002">male</span></p></th>
<th class="cl-8b07ba0e"><p class="cl-8b07b124"><span class="cl-8b067002">female</span></p></th>
<th class="cl-8b07ba0e"><p class="cl-8b07b124"><span class="cl-8b067002">male</span></p></th>
<th class="cl-8b07ba0e"><p class="cl-8b07b124"><span class="cl-8b067002">female</span></p></th>
<th class="cl-8b07ba0e"><p class="cl-8b07b124"><span class="cl-8b067002">male</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b06700c">2007</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b06700d">37.92</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b06700d">39.95</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b067016">46.57</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b067017">50.88</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b067016">45.06</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b067016">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b06700c">2008</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b06700d">36.52</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b067016">40.60</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b067016">46.00</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b067017">51.40</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b067016">45.30</span></p></td>
<td class="cl-8b07ba16"><p class="cl-8b07b124"><span class="cl-8b067016">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b07ba17"><p class="cl-8b07b124"><span class="cl-8b06700c">2009</span></p></td>
<td class="cl-8b07ba17"><p class="cl-8b07b124"><span class="cl-8b06700d">37.41</span></p></td>
<td class="cl-8b07ba17"><p class="cl-8b07b124"><span class="cl-8b067016">40.56</span></p></td>
<td class="cl-8b07ba17"><p class="cl-8b07b124"><span class="cl-8b067016">47.01</span></p></td>
<td class="cl-8b07ba17"><p class="cl-8b07b124"><span class="cl-8b067017">51.10</span></p></td>
<td class="cl-8b07ba17"><p class="cl-8b07b124"><span class="cl-8b067016">46.26</span></p></td>
<td class="cl-8b07ba17"><p class="cl-8b07b124"><span class="cl-8b067017">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You can also select rows or columns with the <code>i</code> and <code>j</code> arguments, using formula syntax. To target rows, provide <code>i</code> with a formula to filter through the rows. Here we color in red rows for years greater than 2007:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-18_d1677b76b89cfa08237db81716401dad">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/color.html">color</a></span><span class="op">(</span>i <span class="op">=</span> <span class="op">~</span> <span class="va">year</span> <span class="op">&gt;</span> <span class="fl">2007</span>, color <span class="op">=</span> <span class="st">"red"</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-8b1f6422{}.cl-8b1c88ce{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8b1c88d8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-8b1da89e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b1da8a8{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b1da8a9{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b1db10e{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b1db10f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b1db118{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b1db119{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b1db11a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b1db122{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b1db123{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-8b1f6422">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-8b1db10e"><p class="cl-8b1da89e"><span class="cl-8b1c88ce">year</span></p></th>
<th colspan="2" class="cl-8b1db10f"><p class="cl-8b1da8a8"><span class="cl-8b1c88ce">Adelie</span></p></th>
<th colspan="2" class="cl-8b1db10f"><p class="cl-8b1da8a8"><span class="cl-8b1c88ce">Chinstrap</span></p></th>
<th colspan="2" class="cl-8b1db10f"><p class="cl-8b1da8a8"><span class="cl-8b1c88ce">Gentoo</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-8b1db11a"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">female</span></p></th>
<th class="cl-8b1db11a"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">male</span></p></th>
<th class="cl-8b1db11a"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">female</span></p></th>
<th class="cl-8b1db11a"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">male</span></p></th>
<th class="cl-8b1db11a"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">female</span></p></th>
<th class="cl-8b1db11a"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">male</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">2007</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">37.92</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">39.95</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">46.57</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">50.88</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">45.06</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88ce">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">2008</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">36.52</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">40.60</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">46.00</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">51.40</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">45.30</span></p></td>
<td class="cl-8b1db122"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b1db123"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">2009</span></p></td>
<td class="cl-8b1db123"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">37.41</span></p></td>
<td class="cl-8b1db123"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">40.56</span></p></td>
<td class="cl-8b1db123"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">47.01</span></p></td>
<td class="cl-8b1db123"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">51.10</span></p></td>
<td class="cl-8b1db123"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">46.26</span></p></td>
<td class="cl-8b1db123"><p class="cl-8b1da8a9"><span class="cl-8b1c88d8">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>You can restrict this to specific columns with the <code>j</code> argument:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-19_f1de822af156b78afc5c48bbd27b0bae">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/color.html">color</a></span><span class="op">(</span>i <span class="op">=</span> <span class="op">~</span> <span class="va">year</span> <span class="op">&gt;</span> <span class="fl">2007</span>, j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"Adelie_female"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid">
<style>.cl-8b2aca56{}.cl-8b27f650{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8b27f65a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-8b29106c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b291076{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b291077{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8b2918be{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b2918c8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b2918c9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b2918ca{width:0.75in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b2918d2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b2918d3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8b2918d4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-8b2aca56">
<thead>
<tr style="overflow-wrap:break-word;">
<th rowspan="2" class="cl-8b2918be"><p class="cl-8b29106c"><span class="cl-8b27f650">year</span></p></th>
<th colspan="2" class="cl-8b2918c8"><p class="cl-8b291076"><span class="cl-8b27f650">Adelie</span></p></th>
<th colspan="2" class="cl-8b2918c8"><p class="cl-8b291076"><span class="cl-8b27f650">Chinstrap</span></p></th>
<th colspan="2" class="cl-8b2918c8"><p class="cl-8b291076"><span class="cl-8b27f650">Gentoo</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-8b2918d2"><p class="cl-8b291077"><span class="cl-8b27f650">female</span></p></th>
<th class="cl-8b2918d2"><p class="cl-8b291077"><span class="cl-8b27f650">male</span></p></th>
<th class="cl-8b2918d2"><p class="cl-8b291077"><span class="cl-8b27f650">female</span></p></th>
<th class="cl-8b2918d2"><p class="cl-8b291077"><span class="cl-8b27f650">male</span></p></th>
<th class="cl-8b2918d2"><p class="cl-8b291077"><span class="cl-8b27f650">female</span></p></th>
<th class="cl-8b2918d2"><p class="cl-8b291077"><span class="cl-8b27f650">male</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">2007</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">37.92</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">39.95</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">46.57</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">50.88</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">45.06</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">49.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f65a">2008</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f65a">36.52</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">40.60</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">46.00</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">51.40</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">45.30</span></p></td>
<td class="cl-8b2918d3"><p class="cl-8b291077"><span class="cl-8b27f650">48.54</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-8b2918d4"><p class="cl-8b291077"><span class="cl-8b27f65a">2009</span></p></td>
<td class="cl-8b2918d4"><p class="cl-8b291077"><span class="cl-8b27f65a">37.41</span></p></td>
<td class="cl-8b2918d4"><p class="cl-8b291077"><span class="cl-8b27f650">40.56</span></p></td>
<td class="cl-8b2918d4"><p class="cl-8b291077"><span class="cl-8b27f650">47.01</span></p></td>
<td class="cl-8b2918d4"><p class="cl-8b291077"><span class="cl-8b27f650">51.10</span></p></td>
<td class="cl-8b2918d4"><p class="cl-8b291077"><span class="cl-8b27f650">46.26</span></p></td>
<td class="cl-8b2918d4"><p class="cl-8b291077"><span class="cl-8b27f650">50.88</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="getting-flextables-into-word" class="level3"><h3 class="anchored" data-anchor-id="getting-flextables-into-word">Getting <code>flextable</code>s into Word</h3>
<p>There are three main ways to get a <code>flextable</code> into Word: open a temporary preview file that you can copy from with <code>print(preview = "docx")</code>, save to a Word file with <code><a href="https://davidgohel.github.io/flextable/reference/save_as_docx.html">save_as_docx()</a></code>, or insert into an existing Word document with the <code>officer</code> package.</p>
<section id="temporary-word-file" class="level4"><h4 class="anchored" data-anchor-id="temporary-word-file">Temporary Word file</h4>
<p>This is probably the easiest method. The following code opens a new temporary document in Word (assuming it’s installed on your computer) that contains the <code>flextable</code> object.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-20_b72233f92727c34570515ce90c53616a">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>preview <span class="op">=</span> <span class="st">"docx"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>That’s it! You can now copy and paste that table wherever you need. NB: this creates a <em>temporary file</em> which will be deleted when your R session closes, so save any output you want in a separate document.</p>
</section><section id="save-to-a-new-word-file" class="level4"><h4 class="anchored" data-anchor-id="save-to-a-new-word-file">Save to a new Word file</h4>
<p><code>save_as_docx</code> will do as the name suggests—insert the <code>flextable</code> into a new .docx file whose location you specify:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-21_0315c8fcb2723853bd262339c6869ee3">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_flextable_4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/save_as_docx.html">save_as_docx</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"penguin_table.docx"</span><span class="op">)</span> <span class="co"># I find it necessary to explicitly name the path argument</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="import-into-an-existing-word-file." class="level4"><h4 class="anchored" data-anchor-id="import-into-an-existing-word-file.">Import into an existing Word file.</h4>
<p>The package <code>officer</code> lets you read a Word document into R, manipulate it, and save it again with any additions or changes.</p>
<p>Read in an existing Word document with <code><a href="https://davidgohel.github.io/officer/reference/read_docx.html">officer::read_docx()</a></code>. Here I’ll read the <code>penguin_table.docx</code> document we created above.:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-22_1755dd840246a6502c2e60d118527343">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_doc</span> <span class="op">&lt;-</span> <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/read_docx.html">read_docx</a></span><span class="op">(</span><span class="st">"penguin_table.docx"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now add your <code>flextable</code> with <code><a href="https://davidgohel.github.io/flextable/reference/body_add_flextable.html">flextable::body_add_flextable()</a></code>:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-23_b3faecde7a49e3a93f63b78dacee4cab">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_doc</span> <span class="op">&lt;-</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/body_add_flextable.html">body_add_flextable</a></span><span class="op">(</span><span class="va">penguin_doc</span>, <span class="va">penguin_flextable_4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And finally, save this Word object as a Word document:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-24_cfa46f028034ebad593f7092463786ff">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguin_doc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>target <span class="op">=</span> <span class="st">"penguin_table.docx"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>That’s it! <code>flextable</code> has a bunch more functionality, but these are the things I find myself using regularly. Check out <a href="https://davidgohel.github.io/flextable/">the <code>flextable</code> page</a> or <a href="https://ardata-fr.github.io/flextable-book/">the <code>flextable</code> book</a> (free online).</p>
<!-- End content -->
<div id="footer-session-info">
<details><summary>
Session info and package versions
</summary><div class="cell" data-hash="index_cache/html/unnamed-chunk-26_dfcf0a79facc89701596347f92e73150">
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> setting  value
 version  R version 4.4.0 (2024-04-24)
 os       macOS Sonoma 14.4.1
 system   aarch64, darwin20
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2024-05-17
 pandoc   3.2 @ /opt/homebrew/bin/ (via rmarkdown)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>─ Packages ───────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           package loadedversion       date         source
           askpass         1.2.0 2023-09-03 CRAN (R 4.4.0)
               cli         3.6.2 2023-12-11 CRAN (R 4.4.0)
         codetools        0.2-20 2024-03-31 CRAN (R 4.4.0)
        colorspace         2.1-0 2023-01-23 CRAN (R 4.4.0)
            crayon         1.5.2 2022-09-29 CRAN (R 4.4.0)
              crul         1.4.2 2024-04-09 CRAN (R 4.4.0)
              curl         5.2.1 2024-03-01 CRAN (R 4.4.0)
        data.table        1.15.4 2024-03-30 CRAN (R 4.4.0)
            digest        0.6.35 2024-03-11 CRAN (R 4.4.0)
             dplyr         1.1.4 2023-11-17 CRAN (R 4.4.0)
          evaluate          0.23 2023-11-01 CRAN (R 4.4.0)
             fansi         1.0.6 2023-12-08 CRAN (R 4.4.0)
           fastmap         1.1.1 2023-02-24 CRAN (R 4.4.0)
         flextable         0.9.6 2024-05-05 CRAN (R 4.4.0)
 fontBitstreamVera         0.1.1 2017-02-01 CRAN (R 4.4.0)
    fontLiberation         0.1.0 2016-10-15 CRAN (R 4.4.0)
        fontquiver         0.2.1 2017-02-01 CRAN (R 4.4.0)
           forcats         1.0.0 2023-01-29 CRAN (R 4.4.0)
           gdtools         0.3.7 2024-03-05 CRAN (R 4.4.0)
          generics         0.1.3 2022-07-05 CRAN (R 4.4.0)
            gfonts         0.2.0 2023-01-08 CRAN (R 4.4.0)
           ggplot2         3.5.1 2024-04-23 CRAN (R 4.4.0)
              glue         1.7.0 2024-01-09 CRAN (R 4.4.0)
                gt        0.10.1 2024-01-17 CRAN (R 4.4.0)
            gtable         0.3.5 2024-04-22 CRAN (R 4.4.0)
               hms         1.1.3 2023-03-21 CRAN (R 4.4.0)
         htmltools       0.5.8.1 2024-04-04 CRAN (R 4.4.0)
       htmlwidgets         1.6.4 2023-12-06 CRAN (R 4.4.0)
          httpcode         0.3.0 2020-04-10 CRAN (R 4.4.0)
            httpuv        1.6.15 2024-03-26 CRAN (R 4.4.0)
          jsonlite         1.8.8 2023-12-04 CRAN (R 4.4.0)
             knitr          1.46 2024-04-06 CRAN (R 4.4.0)
             later         1.3.2 2023-12-06 CRAN (R 4.4.0)
         lifecycle         1.0.4 2023-11-07 CRAN (R 4.4.0)
         lubridate         1.9.3 2023-09-27 CRAN (R 4.4.0)
          magrittr         2.0.3 2022-03-30 CRAN (R 4.4.0)
              mime          0.12 2021-09-28 CRAN (R 4.4.0)
           munsell         0.5.1 2024-04-01 CRAN (R 4.4.0)
           officer         0.6.6 2024-05-05 CRAN (R 4.4.0)
           openssl         2.1.2 2024-04-21 CRAN (R 4.4.0)
    palmerpenguins         0.1.1 2022-08-15 CRAN (R 4.4.0)
            pillar         1.9.0 2023-03-22 CRAN (R 4.4.0)
         pkgconfig         2.0.3 2019-09-22 CRAN (R 4.4.0)
          promises         1.3.0 2024-04-05 CRAN (R 4.4.0)
             purrr         1.0.2 2023-08-10 CRAN (R 4.4.0)
                R6         2.5.1 2021-08-19 CRAN (R 4.4.0)
              ragg         1.3.1 2024-05-06 CRAN (R 4.4.0)
              Rcpp        1.0.12 2024-01-09 CRAN (R 4.4.0)
             readr         2.1.5 2024-01-10 CRAN (R 4.4.0)
              renv        0.17.3 2023-04-06 CRAN (R 4.4.0)
             rlang         1.1.3 2024-01-10 CRAN (R 4.4.0)
         rmarkdown          2.26 2024-03-05 CRAN (R 4.4.0)
        rstudioapi        0.16.0 2024-03-24 CRAN (R 4.4.0)
            scales         1.3.0 2023-11-28 CRAN (R 4.4.0)
       sessioninfo         1.2.2 2021-12-06 CRAN (R 4.4.0)
             shiny       1.8.1.1 2024-04-02 CRAN (R 4.4.0)
           stringi         1.8.4 2024-05-06 CRAN (R 4.4.0)
           stringr         1.5.1 2023-11-14 CRAN (R 4.4.0)
       systemfonts         1.0.6 2024-03-07 CRAN (R 4.4.0)
       textshaping         0.3.7 2023-10-09 CRAN (R 4.4.0)
            tibble         3.2.1 2023-03-20 CRAN (R 4.4.0)
             tidyr         1.3.1 2024-01-24 CRAN (R 4.4.0)
        tidyselect         1.2.1 2024-03-11 CRAN (R 4.4.0)
         tidyverse         2.0.0 2023-02-22 CRAN (R 4.4.0)
        timechange         0.3.0 2024-01-18 CRAN (R 4.4.0)
              tzdb         0.4.0 2023-05-12 CRAN (R 4.4.0)
              utf8         1.2.4 2023-10-22 CRAN (R 4.4.0)
              uuid         1.2-0 2024-01-14 CRAN (R 4.4.0)
             vctrs         0.6.5 2023-12-01 CRAN (R 4.4.0)
             withr         3.0.0 2024-01-16 CRAN (R 4.4.0)
              xfun          0.43 2024-03-25 CRAN (R 4.4.0)
              xml2         1.3.6 2023-12-04 CRAN (R 4.4.0)
            xtable         1.8-4 2019-04-21 CRAN (R 4.4.0)
              yaml         2.3.8 2023-12-11 CRAN (R 4.4.0)
               zip         2.3.1 2024-01-27 CRAN (R 4.4.0)</code></pre>
</div>
</div>
</details>
</div>


</section><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>If you’re reading this some time in the future, it might be worth checking that issue to see if it’s been resolved.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>